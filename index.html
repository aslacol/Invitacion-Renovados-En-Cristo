<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invitación Especial - 5to Aniversario</title>
    <link rel="icon" type="image/png" href="https://i.ibb.co/j3d6d6b/dove-icon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Lato:wght@300;400;700&family=Dancing+Script:wght@400;700&family=Cormorant+Garamond:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lato', sans-serif;
            /* Paleta de colores con más contraste para un movimiento notable */
            background: linear-gradient(270deg, #2c5282, #60a5fa, #bfdbfe);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: -10%; /* Extender para permitir movimiento sin bordes */
            left: -10%;
            width: 120%; /* Hacer más grande para el efecto de zoom y paneo */
            height: 120%;
            background-image: url('https://i.ibb.co/1tZwYSD5/Copia-de-aniversario-iglesia-4.png');
            background-size: cover;
            background-position: center;
            opacity: 0.15;
            z-index: 0;
            pointer-events: none;
            /* Nueva animación de zoom y paneo para evitar cortes */
            animation: moveSky 60s ease-in-out infinite;
        }

        @keyframes moveSky {
            0% {
                transform: scale(1) translate(0, 0);
            }
            50% {
                transform: scale(1.1) translate(-5%, 5%);
            }
            100% {
                transform: scale(1) translate(0, 0);
            }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .font-display {
            font-family: 'Playfair Display', serif;
        }

        .font-script {
            font-family: 'Dancing Script', cursive;
        }

        .font-elegant {
            font-family: 'Cormorant Garamond', serif;
        }

        /* Animaciones mejoradas */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        .card-enter {
            animation: fadeInUp 0.8s ease-out;
        }

        .invitation-reveal {
            animation: fadeInUp 1s ease-out;
        }

        .floating {
            animation: float 3s ease-in-out infinite;
        }

        /* Glassmorphism mejorado */
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 
                0 8px 32px 0 rgba(31, 38, 135, 0.37),
                0 0 0 1px rgba(255, 255, 255, 0.1) inset;
        }

        /* Texto dorado mejorado */
        .text-gold {
            background: linear-gradient(135deg, #d4af37 0%, #f4e5a1 50%, #d4af37 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.2));
            animation: shimmer 3s infinite linear;
            background-size: 200% auto;
        }

        /* Botones mejorados */
        .btn-primary {
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-primary:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .btn-primary:active {
            transform: translateY(-1px);
        }

        /* WhatsApp button mejorado */
        .btn-whatsapp {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            transition: all 0.3s ease;
        }

        .btn-whatsapp:hover {
            background: linear-gradient(135deg, #128C7E 0%, #075E54 100%);
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 25px rgba(37, 211, 102, 0.4);
        }

        /* Mensaje generado mejorado */
        #generated-message {
            background: linear-gradient(135deg, #e0f7fa 0%, #f1f8ff 100%);
            border: 2px solid #81d4fa;
            border-radius: 12px;
            padding: 20px;
            white-space: pre-wrap;
            word-wrap: break-word;
            text-align: left;
            color: #01579b;
            font-size: 14px;
            line-height: 1.6;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        /* Inputs mejorados */
        input[type="text"],
        input[type="tel"] {
            transition: all 0.3s ease;
            border: 2px solid #e0e0e0;
        }

        input[type="text"]:focus,
        input[type="tel"]:focus {
            outline: none;
            border-color: #3b82f6; /* Azul de Tailwind */
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
            transform: translateY(-2px);
        }

        /* Modal mejorado */
        .modal-content {
            animation: fadeInUp 0.5s ease-out;
        }

        /* Decorative elements */
        .sparkle {
            display: inline-block;
            animation: sparkleRotate 2s linear infinite;
        }

        @keyframes sparkleRotate {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.2); }
        }

        /* Imagen con efecto hover */
        .invitation-image {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .invitation-image:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        /* Divider decorativo */
        .divider {
            height: 2px;
            background: linear-gradient(90deg, transparent, #d4af37, transparent);
            margin: 20px 0;
        }

        /* Loading animation */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .copy-feedback {
            animation: pulse 0.5s ease-in-out;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div id="app-container" class="max-w-lg w-full relative z-10">

        <!-- VISTA DE INVITACIÓN (lo que ve el invitado) -->
        <div id="invitation-view" class="hidden">
            
            <!-- Sección de Pre-Invitación -->
            <div id="pre-invitacion" class="text-center glass-card p-8 md:p-12 rounded-2xl shadow-2xl card-enter">
                <div class="floating mb-6">
                    <svg class="w-20 h-20 mx-auto text-gold" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/>
                        <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/>
                    </svg>
                </div>
                
                <h1 id="nombre-invitado" class="font-script text-5xl md:text-6xl text-gold font-bold mb-6 leading-tight"></h1>
                
                <div class="divider"></div>
                
                <p class="text-gray-700 mb-8 text-lg font-elegant">
                    Has recibido una invitación especial<br>
                    para un tiempo de bendición y celebración
                </p>
                
                <button onclick="mostrarInvitacion()" class="btn-primary bg-gradient-to-r from-sky-500 to-blue-600 text-white font-bold py-4 px-10 rounded-full hover:from-sky-600 hover:to-blue-700 shadow-lg inline-flex items-center space-x-3">
                    <span class="sparkle text-2xl">✨</span>
                    <span class="text-lg">Abrir Invitación</span>
                    <span class="sparkle text-2xl">✨</span>
                </button>
            </div>

            <!-- Sección de la Invitación Completa -->
            <div id="invitacion-completa" class="hidden text-center glass-card p-6 md:p-8 rounded-2xl shadow-2xl invitation-reveal">
                
                <h2 id="nombre-invitado-final" class="font-script text-4xl md:text-5xl text-gold font-bold my-6 leading-tight"></h2>
                
                <div class="divider"></div>
                
                <img onclick="mostrarImagenCompleta()" 
                     src="https://i.ibb.co/qLtqpx1q/Copia-de-aniversario-iglesia.png" 
                     alt="Invitación al 5to Aniversario" 
                     class="invitation-image rounded-xl w-full shadow-lg my-6">
                
                <div class="divider"></div>
                
                <div class="pt-4 pb-2">
                    <p class="text-gray-800 mb-6 text-lg font-elegant leading-relaxed">
                        ¡Esperamos contar con tu presencia! 🙏<br>
                        <span class="font-bold text-blue-800">Por favor, confirma tu asistencia</span>
                    </p>
                    
                    <button onclick="confirmarAsistencia()" class="btn-whatsapp btn-primary text-white font-bold py-4 px-8 rounded-full shadow-lg inline-flex items-center space-x-3 text-lg">
                        <!-- ICONO OFICIAL DE WHATSAPP -->
                        <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                        </svg>
                        <span>Confirmar por WhatsApp</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- HERRAMIENTA GENERADOR DE ENLACES (oculta por defecto) -->
        <div id="generator-view" class="hidden">
            <div class="text-center glass-card p-8 md:p-12 rounded-2xl shadow-2xl card-enter">
                
                <div class="mb-6">
                    <svg class="w-16 h-16 mx-auto text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                    </svg>
                </div>

                <h2 class="font-display text-3xl md:text-4xl text-transparent bg-clip-text bg-gradient-to-r from-sky-500 to-blue-600 mb-3 font-bold">
                    Generador de Invitaciones
                </h2>
                
                <p class="text-gray-600 mb-8 font-elegant">Crea enlaces personalizados para tus invitados</p>
                
                <div class="divider"></div>

                <div class="space-y-6 text-left mt-8">
                    <!-- Nombre del invitado -->
                    <div>
                        <label for="g-nombre" class="font-bold text-gray-700 flex items-center mb-2 text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
                            </svg>
                            <span>Nombre del Invitado</span>
                        </label>
                        <input type="text" 
                               id="g-nombre" 
                               placeholder="Ej: Familia Pérez" 
                               class="w-full p-3 border-2 rounded-xl focus:outline-none">
                    </div>
                     
                    <!-- WhatsApp del invitado -->
                    <div>
                        <label for="g-whatsapp" class="font-bold text-gray-700 flex items-center mb-2 text-sm">
                            <svg class="h-5 w-5 mr-2 text-green-600" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                            </svg>
                            <span>WhatsApp del Invitado</span>
                        </label>
                        <input type="tel" 
                               id="g-whatsapp" 
                               placeholder="Ej: 573001234567" 
                               class="w-full p-3 border-2 rounded-xl focus:outline-none">
                        <p class="text-xs text-gray-500 mt-1 ml-1">Incluye código de país sin el símbolo +</p>
                    </div>
                    
                    <!-- WhatsApp para recibir confirmación -->
                    <div>
                        <label for="g-confirm-whatsapp" class="font-bold text-gray-700 flex items-center mb-2 text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z" />
                            </svg>
                            <span>Tu WhatsApp (para confirmaciones)</span>
                        </label>
                        <input type="tel" 
                               id="g-confirm-whatsapp" 
                               placeholder="Ej: 573101112233" 
                               class="w-full p-3 border-2 rounded-xl focus:outline-none">
                        <p class="text-xs text-gray-500 mt-1 ml-1">Aquí recibirás las confirmaciones de asistencia</p>
                    </div>
                </div>

                <button onclick="generarMensaje()" class="btn-primary w-full bg-gradient-to-r from-sky-500 to-blue-700 text-white font-bold py-4 mt-8 rounded-xl shadow-lg text-lg">
                    <span class="flex items-center justify-center space-x-2">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                        </svg>
                        <span>Generar Mensaje</span>
                    </span>
                </button>

                <!-- Output section -->
                <div id="output-section" class="hidden mt-8 text-left space-y-4">
                    <div class="divider"></div>
                    
                    <p class="font-bold text-gray-800 flex items-center text-lg">
                        <svg class="w-5 h-5 mr-2 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                        Mensaje generado:
                    </p>
                    
                    <pre id="generated-message"></pre>
                    
                    <div class="flex flex-col sm:flex-row gap-3">
                        <button id="copy-button" 
                                onclick="copiarMensaje()" 
                                class="btn-primary flex-1 bg-gradient-to-r from-gray-600 to-gray-700 text-white font-bold py-3 rounded-xl shadow-lg hover:from-gray-700 hover:to-gray-800 flex items-center justify-center space-x-2">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"/>
                                <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"/>
                            </svg>
                            <span>Copiar</span>
                        </button>
                        
                        <button onclick="enviarMensaje()" 
                                class="btn-whatsapp btn-primary flex-1 text-white font-bold py-3 rounded-xl shadow-lg flex items-center justify-center space-x-2">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                            </svg>
                            <span>Enviar</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para la Imagen Mejorado -->
    <div id="image-modal" class="hidden fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4" onclick="cerrarImagenCompleta()">
        <div class="modal-content bg-white p-3 rounded-2xl shadow-2xl max-w-4xl w-full relative" onclick="event.stopPropagation()">
            <button onclick="cerrarImagenCompleta()" 
                    class="absolute -top-4 -right-4 bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white rounded-full p-2 text-2xl font-bold z-10 w-12 h-12 flex items-center justify-center shadow-lg transition-all hover:scale-110">
                &times;
            </button>
            <img src="https://i.ibb.co/qLtqpx1q/Copia-de-aniversario-iglesia.png" 
                 class="rounded-xl w-full shadow-2xl">
        </div>
    </div>

    <script>
        // --- LÓGICA DE VISUALIZACIÓN INICIAL ---
        window.onload = function() {
            const params = new URLSearchParams(window.location.search);
            const nombre = params.get('invitado');
            const generar = params.get('generar');

            if (generar === 'true') {
                document.getElementById('invitation-view').classList.add('hidden');
                document.getElementById('generator-view').classList.remove('hidden');
            } else if (nombre) {
                document.getElementById('generator-view').classList.add('hidden');
                document.getElementById('invitation-view').classList.remove('hidden');
                const nombreDecoded = decodeURIComponent(nombre.replace(/\+/g, ' '));
                document.getElementById('nombre-invitado').textContent = nombreDecoded;
                document.getElementById('nombre-invitado-final').textContent = nombreDecoded;
            } else {
                document.getElementById('invitation-view').classList.add('hidden');
                document.getElementById('generator-view').classList.remove('hidden');
            }
        };

        function mostrarInvitacion() {
            document.getElementById('pre-invitacion').style.display = 'none';
            document.getElementById('invitacion-completa').classList.remove('hidden');
        }
        
        function confirmarAsistencia() {
            const params = new URLSearchParams(window.location.search);
            const nombre = decodeURIComponent(params.get('invitado')?.replace(/\+/g, ' ') || 'Invitado Especial');
            
            // Lógica de fallback para el número de WhatsApp
            // Primero, intenta obtener el número del parámetro 'confirmar_a' en el enlace.
            let numeroWhatsapp = params.get('confirmar_a');

            // Si el parámetro no existe (para los enlaces antiguos), usa el número por defecto.
            if (!numeroWhatsapp) {
                numeroWhatsapp = '573167467514'; // Este es el número de respaldo (el 316...)
            }

            const horaActual = new Date().toLocaleString("en-US", {timeZone: "America/Bogota", hour: '2-digit', hour12: false});
            const horaNumero = parseInt(horaActual);

            let saludo;
            if (horaNumero >= 5 && horaNumero < 12) { 
                saludo = '¡Buenos días! ☀️';
            } else if (horaNumero >= 12 && horaNumero < 18) { 
                saludo = '¡Buenas tardes! 🌤️';
            } else { 
                saludo = '¡Buenas noches! 🌙';
            }

            const mensaje = `${saludo}\n\n✨ Bendiciones ✨\n\nConfirmo mi asistencia al 5to Aniversario de la Iglesia Renovados en Cristo.\n\nAtentamente,\n${nombre} 🙏`;
            
            const urlWhatsapp = `https://wa.me/${numeroWhatsapp}?text=${encodeURIComponent(mensaje)}`;
            window.open(urlWhatsapp, '_blank');
        }

        function mostrarImagenCompleta() { 
            document.getElementById('image-modal').classList.remove('hidden'); 
        }
        
        function cerrarImagenCompleta() { 
            document.getElementById('image-modal').classList.add('hidden'); 
        }

        // Cerrar modal con tecla ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                cerrarImagenCompleta();
            }
        });

        // --- LÓGICA DEL GENERADOR DE ENLACES ---
        function generarMensaje() {
            const nombre = document.getElementById('g-nombre').value.trim();
            const whatsappInvitado = document.getElementById('g-whatsapp').value.trim();
            const confirmWhatsapp = document.getElementById('g-confirm-whatsapp').value.trim();

            if (!nombre) { 
                alert("⚠️ Por favor, ingresa el nombre del invitado."); 
                document.getElementById('g-nombre').focus();
                return; 
            }
            
            if (!confirmWhatsapp) { 
                alert("⚠️ Por favor, ingresa tu número de WhatsApp para recibir la confirmación."); 
                document.getElementById('g-confirm-whatsapp').focus();
                return; 
            }

            const baseUrl = 'https://aslacol.github.io/Invitacion-Renovados-En-Cristo/';
            let link = `${baseUrl}?invitado=${encodeURIComponent(nombre)}`;
            link += `&confirmar_a=${encodeURIComponent(confirmWhatsapp.replace(/\s/g, '').replace(/\+/g, ''))}`;

            const mensaje = `✨ ¡Bendiciones, ${nombre}! ✨\n\n😊 Con gran alegría te extendemos esta invitación especial para celebrar juntos el 5to Aniversario de nuestra amada Iglesia Renovados en Cristo.\n\n🙏 Será un tiempo de gozo, adoración y gratitud por todo lo que Dios ha hecho.\n\n💫 Esperamos contar con tu valiosa presencia.\n\n━━━━━━━━━━━━━━━━━━━━━━━\n\n📩 Para ver tu invitación personal, haz clic en el siguiente enlace:\n\n${link}\n\n━━━━━━━━━━━━━━━━━━━━━━━\n\n🕊️ ¡Dios te bendiga! 🕊️`;

            document.getElementById('generated-message').textContent = mensaje;
            
            // Scroll suave al resultado
            setTimeout(() => {
                document.getElementById('output-section').scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'nearest' 
                });
            }, 100);
            document.getElementById('output-section').classList.remove('hidden');
        }

        function copiarMensaje() {
            const mensaje = document.getElementById('generated-message').textContent;
            navigator.clipboard.writeText(mensaje).then(() => {
                const copyButton = document.getElementById('copy-button');
                const originalHTML = copyButton.innerHTML;
                
                copyButton.innerHTML = `
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                    </svg>
                    <span>¡Copiado!</span>
                `;
                
                copyButton.classList.add('copy-feedback');
                
                setTimeout(() => { 
                    copyButton.innerHTML = originalHTML;
                    copyButton.classList.remove('copy-feedback');
                }, 2000);
            }).catch(err => {
                alert('⚠️ Error al copiar. Por favor, copia manualmente.');
                console.error('Error:', err);
            });
        }

        function enviarMensaje() {
            let whatsappNum = document.getElementById('g-whatsapp').value.trim();
            const mensaje = document.getElementById('generated-message').textContent;
            
            if (!whatsappNum) { 
                alert("⚠️ Por favor, ingresa el número de WhatsApp del invitado."); 
                document.getElementById('g-whatsapp').focus();
                return; 
            }
            
            whatsappNum = whatsappNum.replace(/\s/g, '').replace(/\+/g, '');

            const urlWhatsapp = `https://wa.me/${whatsappNum}?text=${encodeURIComponent(mensaje)}`;
            window.open(urlWhatsapp, '_blank');
        }
    </script>
</body>
</html>
